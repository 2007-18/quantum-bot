import fetch from"node-fetch";import{FormData,Blob}from"formdata-node";import{JSDOM}from"jsdom";import{fileTypeFromBuffer}from"file-type";async function webp2mp4(e){const t=new FormData,o="string"==typeof e&&/https?:\/\//.test(e),n=o?new Blob:new Blob([e]);t.append("new-image-url",o?n:""),t.append("new-image",o?"":n,"image.webp");const a=await fetch("https://s6.ezgif.com/webp-to-mp4",{method:"POST",body:t}),m=await a.text(),{document:p}=new JSDOM(m).window,r=new FormData,i={};for(const e of p.querySelectorAll("form input[name]"))i[e.name]=e.value,r.append(e.name,e.value);const w=await fetch("https://ezgif.com/webp-to-mp4/"+i.file,{method:"POST",body:r}),c=await w.text(),{document:u}=new JSDOM(c).window;return new URL(u.querySelector("div#output > p.outfile > video > source").src,w.url).toString()}async function webp2png(e){const t=new FormData,o="string"==typeof e&&/https?:\/\//.test(e),n=o?new Blob:new Blob([e]);t.append("new-image-url",o?n:""),t.append("new-image",o?"":n,"image.webp");const a=await fetch("https://s6.ezgif.com/webp-to-png",{method:"POST",body:t}),m=await a.text(),{document:p}=new JSDOM(m).window,r=new FormData,i={};for(const e of p.querySelectorAll("form input[name]"))i[e.name]=e.value,r.append(e.name,e.value);const w=await fetch("https://ezgif.com/webp-to-png/"+i.file,{method:"POST",body:r}),c=await w.text(),{document:u}=new JSDOM(c).window;return new URL(u.querySelector("div#output > p.outfile > img").src,w.url).toString()}async function img2url(e){try{const{ext:t,mime:o}=await fileTypeFromBuffer(e),n=new FormData;n.append("file",new Blob([e],{type:o}),`tmp.${t}`);const a=await fetch("https://telegra.ph/upload",{method:"POST",body:n}),m=await a.json();return m.error?"https://raw.githubusercontent.com/NeoKode/multimedia/main/NKimagen/404.png":`https://telegra.ph${m[0].src}`}catch{return"https://raw.githubusercontent.com/NeoKode/multimedia/main/NKimagen/404.png"}}export{webp2mp4,webp2png,img2url}; /* @NeKosmic */
